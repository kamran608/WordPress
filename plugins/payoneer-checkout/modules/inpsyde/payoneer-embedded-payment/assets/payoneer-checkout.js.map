{"version":3,"file":"payoneer-checkout.js","mappings":"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","sources":["webpack://payoneer-embedded-payment/./node_modules/react/cjs/react-jsx-runtime.production.min.js","webpack://payoneer-embedded-payment/external window \"React\"","webpack://payoneer-embedded-payment/./node_modules/react/jsx-runtime.js","webpack://payoneer-embedded-payment/webpack/bootstrap","webpack://payoneer-embedded-payment/webpack/runtime/compat get default export","webpack://payoneer-embedded-payment/webpack/runtime/define property getters","webpack://payoneer-embedded-payment/webpack/runtime/hasOwnProperty shorthand","webpack://payoneer-embedded-payment/webpack/runtime/make namespace object","webpack://payoneer-embedded-payment/external window \"jQuery\"","webpack://payoneer-embedded-payment/./resources/js/src/util/woocommerce.js","webpack://payoneer-embedded-payment/external window [\"wp\",\"data\"]","webpack://payoneer-embedded-payment/./resources/js/src/store/constants.js","webpack://payoneer-embedded-payment/./resources/js/src/store/reducer.js","webpack://payoneer-embedded-payment/external window [\"wp\",\"hooks\"]","webpack://payoneer-embedded-payment/./resources/js/src/util/components.js","webpack://payoneer-embedded-payment/./resources/js/src/store/actions.js","webpack://payoneer-embedded-payment/external window [\"wp\",\"apiFetch\"]","webpack://payoneer-embedded-payment/./resources/js/src/store/resolvers.js","webpack://payoneer-embedded-payment/./resources/js/src/util/sdk/umdLoader.js","webpack://payoneer-embedded-payment/./resources/js/src/store/selectors.js","webpack://payoneer-embedded-payment/./resources/js/src/store/index.js","webpack://payoneer-embedded-payment/./resources/js/src/util/http.js","webpack://payoneer-embedded-payment/external window [\"wc\",\"wcBlocksData\"]","webpack://payoneer-embedded-payment/./resources/js/src/store/storeListeners.js","webpack://payoneer-embedded-payment/./resources/js/src/util/OrderPlacementManager.js","webpack://payoneer-embedded-payment/./resources/js/src/util/checkout/classicCheckout.js","webpack://payoneer-embedded-payment/./resources/js/src/components/widgetContainer/component.js","webpack://payoneer-embedded-payment/./resources/js/src/components/widgetContainer/provider.js","webpack://payoneer-embedded-payment/./resources/js/src/components/widgetContainer/index.js","webpack://payoneer-embedded-payment/./resources/js/src/util/checkout/blockCheckout.js","webpack://payoneer-embedded-payment/./resources/js/src/util/checkout/paymentCheckout.js","webpack://payoneer-embedded-payment/./resources/js/payoneer-checkout.js"],"sourcesContent":["/**\n * @license React\n * react-jsx-runtime.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var f=require(\"react\"),k=Symbol.for(\"react.element\"),l=Symbol.for(\"react.fragment\"),m=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};\nfunction q(c,a,g){var b,d={},e=null,h=null;void 0!==g&&(e=\"\"+g);void 0!==a.key&&(e=\"\"+a.key);void 0!==a.ref&&(h=a.ref);for(b in a)m.call(a,b)&&!p.hasOwnProperty(b)&&(d[b]=a[b]);if(c&&c.defaultProps)for(b in a=c.defaultProps,a)void 0===d[b]&&(d[b]=a[b]);return{$$typeof:k,type:c,key:e,ref:h,props:d,_owner:n.current}}exports.Fragment=l;exports.jsx=q;exports.jsxs=q;\n","module.exports = window[\"React\"];","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-jsx-runtime.production.min.js');\n} else {\n  module.exports = require('./cjs/react-jsx-runtime.development.js');\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","var __WEBPACK_NAMESPACE_OBJECT__ = window[\"jQuery\"];","import $ from 'jquery';\n\nconst { paymentFieldsComponentAttribute } = window.PayoneerData;\n\nexport const selectedPaymentGateway = () => {\n\treturn document.querySelector( '.woocommerce-checkout input[name=\"payment_method\"]:checked' );\n};\n\nexport const paymentMethodName = () => {\n\treturn selectedPaymentGateway()?.value ?? '';\n};\n\nexport const paymentMethodId = () => {\n\treturn selectedPaymentGateway()?.id ?? '';\n};\n\nexport const getComponentNameFromPaymentBox = function ( paymentBox ) {\n\treturn paymentBox\n\t\t?.querySelector( `[${paymentFieldsComponentAttribute}]` )\n\t\t?.getAttribute( paymentFieldsComponentAttribute );\n};\n/**\n * TODO: Refactor this to be more scalable. Check overlap with getComponentNameByGatewayId()\n * @param gatewayId\n * @returns {*}\n */\nexport const isPayoneerGateway = ( gatewayId ) => {\n\treturn /^payment_method_payoneer-(checkout|afterpay|klarna|affirm|bancontact|eps|ideal|multibanco|p24)/i.test( gatewayId );\n};\n\nexport const isPayoneerGatewaySelected = () =>\n\tisPayoneerGateway( paymentMethodId() );\n\nexport const isPayForOrder = () => {\n\treturn window.PayoneerData.isPayForOrder === '1';\n};\n\nexport const getPaymentBox = ( gatewayId ) => {\n\tconst selector = '.payment_box.' + gatewayId;\n\treturn document.querySelector( selector );\n};\n\nexport const getSelectedPaymentBox = () =>\n\tgetPaymentBox( paymentMethodId() );\n\nconst hostedOverrideFlagInput = () => {\n\tconst { hostedFlowOverrideFlag } = window.PayoneerData;\n\treturn document.querySelector(\n\t\t`input[name=\"${hostedFlowOverrideFlag}\"]`\n\t);\n};\n\nexport const submitOrderPayViaAjax = ( $form ) => {\n\t//Blocks the UI in the same way Woocommerce does (source: https://github.com/woocommerce/woocommerce/blob/6.0.1/plugins/woocommerce/assets/js/frontend/checkout.js#L454-L466)\n\t$form.block( {\n\t\tmessage: null,\n\t\toverlayCSS: {\n\t\t\tbackground: '#fff',\n\t\t\topacity: 0.6,\n\t\t},\n\t} );\n\n\treturn $.ajax( {\n\t\ttype: 'POST',\n\t\turl: window.wc_checkout_params.ajax_url,\n\t\txhrFields: {\n\t\t\t// This is important. We need the session cookie to access the LIST in the back-end\n\t\t\twithCredentials: true,\n\t\t},\n\t\tdataType: 'json',\n\t\tdata: {\n\t\t\taction: 'payoneer_order_pay',\n\t\t\tfields: $form.serialize(),\n\t\t\tparams: new URL( document.location ).searchParams.toString(),\n\t\t},\n\t} ).always( () => $form.unblock() );\n};\n\nexport const isBlockCheckout = () =>\n\twindow?.PayoneerData?.isBlockCheckout === '1';\n\nexport const focusOnSelectedGateway = () => {\n\tselectedPaymentGateway()?.focus();\n};\n","var __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"data\"];","export const ACTIONS = {\n\tSET_EXTENSION_DATA: 'SET_EXTENSION_DATA',\n\tSET_LONG_ID: 'SET_LONG_ID',\n\tSET_LIST_URL: 'SET_LIST_URL',\n\tSET_ENV: 'SET_ENV',\n\tSET_SDK: 'SET_SDK',\n\tSET_SDK_VERSION: 'SET_SDK_VERSION',\n\tSET_SDK_INTEGRITY: 'SET_SDK_INTEGRITY',\n\tSET_SDK_STATE: 'SET_SDK_STATE',\n\tPAY: 'PAY',\n\tSET_ACTIVE_PAYMENT_METHOD: 'SET_ACTIVE_PAYMENT_METHOD',\n\tSET_FORCE_HOSTED_FLOW: 'SET_FORCE_HOSTED_FLOW',\n\tSET_ORDER_ID: 'SET_ORDER_ID',\n\tSET_ON_PAYMENT_UNSUCCESSFUL_NONCE: 'SET_ON_PAYMENT_UNSUCCESSFUL_NONCE',\n\n\t// Component handling actions.\n\n\tADD_COMPONENT: 'ADD_COMPONENT',\n\tREMOVE_COMPONENT: 'REMOVE_COMPONENT',\n\tSET_IS_VALID: 'SET_IS_VALID',\n\tSET_IS_MOUNTED: 'SET_IS_MOUNTED',\n\tSET_IS_READY: 'SET_IS_READY',\n\tMOUNT_COMPONENTS: 'MOUNT_COMPONENTS',\n};\n","import { ACTIONS } from './constants';\n\nconst initialState = {\n\tactivePaymentMethod: '',\n\tlongId: null,\n\tenv: null,\n\tsdkState: 'UNINITIALIZED',\n\tforceHostedFlow: true,\n\n\t/**\n\t * A collection of component related data. Items in this object are keyed\n\t * by the component name and created by the `reduceComponent()` function.\n\t *\n\t * @property {string} key - The component name.\n\t * @property {Component} instance - The SDK component instance.\n\t * @property {boolean} isMounted - Component is present in the DOM.\n\t * @property {boolean} isReady - Component is fully rendered and usable.\n\t * @property {boolean} isValid - Contains valid input, ready for payment.\n\t */\n\tcomponents: {},\n};\n\nconst reduceComponent = ( state, componentName, updates ) => {\n\tconst prevComponent = state.components[ componentName ] || {};\n\n\treturn {\n\t\t...state.components, [ componentName ]: {\n\t\t\tkey: componentName,\n\t\t\tinstance: prevComponent.instance || null,\n\t\t\tisMounted: prevComponent.isMounted || false,\n\t\t\tisReady: prevComponent.isReady || false,\n\t\t\tisValid: prevComponent.isValid || false,\n\t\t\t...updates\n\t\t}\n\t};\n};\n\nconst reducer = ( state = initialState, { type, payload } ) => {\n\tswitch ( type ) {\n\t\tcase ACTIONS.SET_EXTENSION_DATA:\n\t\t\treturn { ...state, extension: payload };\n\t\tcase ACTIONS.SET_LONG_ID:\n\t\t\treturn { ...state, longId: payload };\n\t\tcase ACTIONS.SET_LIST_URL:\n\t\t\treturn { ...state, listUrl: payload };\n\t\tcase ACTIONS.SET_ENV:\n\t\t\treturn { ...state, env: payload };\n\t\tcase ACTIONS.SET_SDK:\n\t\t\treturn { ...state, sdk: payload };\n\t\tcase ACTIONS.SET_SDK_VERSION:\n\t\t\treturn { ...state, sdkVersion: payload };\n\t\tcase ACTIONS.SET_SDK_INTEGRITY:\n\t\t\treturn { ...state, sdkIntegrity: payload };\n\t\tcase ACTIONS.SET_SDK_STATE:\n\t\t\treturn { ...state, sdkState: payload };\n\t\tcase ACTIONS.SET_ACTIVE_PAYMENT_METHOD:\n\t\t\treturn { ...state, activePaymentMethod: payload };\n\t\tcase ACTIONS.SET_FORCE_HOSTED_FLOW:\n\t\t\treturn { ...state, forceHostedFlow: payload };\n\t\tcase ACTIONS.SET_ORDER_ID:\n\t\t\treturn { ...state, orderId: payload };\n\t\tcase ACTIONS.SET_ON_PAYMENT_UNSUCCESSFUL_NONCE:\n\t\t\treturn { ...state, onPaymentUnsuccessfulNonce: payload };\n\n\t\t// Component handling.\n\n\t\tcase ACTIONS.ADD_COMPONENT:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tcomponents: reduceComponent( state, payload.componentName, { instance: payload.instance } ),\n\t\t\t};\n\t\tcase ACTIONS.REMOVE_COMPONENT: {\n\t\t\tconst { [ payload.componentName ]: removed, ...components } = state.components;\n\t\t\treturn { ...state, components };\n\t\t}\n\t\tcase ACTIONS.SET_IS_VALID:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tcomponents: reduceComponent( state, payload.componentName, { isValid: payload.flag } ),\n\t\t\t};\n\t\tcase ACTIONS.SET_IS_MOUNTED:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tcomponents: reduceComponent( state, payload.componentName, { isMounted: payload.flag } ),\n\t\t\t};\n\t\tcase ACTIONS.SET_IS_READY:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tcomponents: reduceComponent( state, payload.componentName, { isReady: payload.flag } ),\n\t\t\t};\n\t\tdefault:\n\t\t\treturn state;\n\t}\n};\n\nexport default reducer;\n","var __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"hooks\"];","const { paymentFieldsComponentAttribute } = window.PayoneerData;\n\nexport const getComponentNameByGatewayId = ( gatewayId ) => {\n\tconst gatewayIdToComponentName = {\n\t\t'payoneer-checkout': 'cards',\n\t\t'payoneer-afterpay': 'afterpay',\n\t\t'payoneer-klarna': 'klarna',\n\t\t'payoneer-affirm': 'affirm',\n\t\t'payoneer-bancontact': 'bancontact',\n\t\t'payoneer-eps': 'eps',\n\t\t'payoneer-ideal': 'ideal',\n\t\t'payoneer-multibanco': 'multibanco',\n\t\t'payoneer-p24': 'p24',\n\t};\n\n\treturn gatewayIdToComponentName[ gatewayId ];\n};\n\nexport const mountSdkComponent = ( componentName, instance, sdk ) => {\n\tif ( !instance || !sdk.isAvailable( componentName ) ) {\n\t\treturn;\n\t}\n\n\tconst container = findComponentContainer( componentName );\n\tif ( !( container instanceof Element ) ) {\n\t\treturn;\n\t}\n\n\tconsole.log( 'mountSdkComponent:', componentName, instance );\n\tinstance.mount( container );\n};\n\nexport const isRedirectComponent = ( instance ) => {\n\tif ( !( instance.element instanceof Element ) ) {\n\t\treturn false;\n\t}\n\n\treturn instance.element.id.includes( 'redirect' );\n};\n\nexport const findComponentContainer = function ( componentName ) {\n\treturn document.querySelector(\n\t\t`[${paymentFieldsComponentAttribute}=${componentName}]`\n\t);\n};\n\nexport const normalizeComponentName = ( componentName, data ) => {\n\t/**\n\t * For Stripe Connect merchant, we can get proper payment method name from `data.methodName`\n\t * For older merchants, data.methodName doesn't exist, and we need componentName.\n\t */\n\tcomponentName = data.methodName ?? componentName;\n\n\t/**\n\t * Also, Stripe Connect uses 'card' instead of 'cards', so we need to fix it.\n\t */\n\treturn componentName === 'card' ? 'cards' : componentName;\n};\n","import $ from 'jquery';\nimport { defaultHooks } from '@wordpress/hooks';\nimport { ACTIONS } from './constants';\nimport {\n\tmountSdkComponent,\n\tisRedirectComponent,\n\tnormalizeComponentName\n} from '../util/components';\n\nconst log = ( ...args ) => console.log( '[action]', ...args );\n\nexport const setLongId = ( longId ) => async ( { select, resolveSelect, dispatch } ) => {\n\tconst sdk = await resolveSelect.getSdk();\n\tawait sdk.updateLongId( longId );\n\tdispatch( { type: ACTIONS.SET_LONG_ID, payload: longId } );\n};\n\nexport const setSdkState = ( sdkState ) => {\n\treturn { type: ACTIONS.SET_SDK_STATE, payload: sdkState };\n};\n\nexport function setEnv( env ) {\n\treturn { type: ACTIONS.SET_ENV, payload: env };\n}\n\nexport const pay = () => ( { select, dispatch } ) => {\n\tconst { instance } = select.getActiveComponent();\n\n\tif ( !instance ) {\n\t\tlog( 'Component not found.' );\n\t\treturn;\n\t}\n\tif ( !instance.pay ) {\n\t\tlog( 'Component does not have a pay method.', instance );\n\t\treturn;\n\t}\n\n\tlog( 'pay -', instance );\n\tinstance.pay();\n};\n\nexport const onBeforeError = ( sdk, component, data ) => async ( { select, dispatch } ) => {\n\tconsole.error( 'callback: onBeforeError -', { sdk, component, data } );\n\tdispatch.setSdkState( sdk.state );\n\n\t/**\n\t * For SYSTEM_FAILURE, we assume there is nothing we can do to recover.\n\t * Use hosted mode fallback and let the customer proceed\n\t */\n\tif ( [ 'SYSTEM_FAILURE' ].includes( data?.interaction?.reason ) ) {\n\t\tdispatch.setForceHostedFlow( true );\n\t\treturn true;\n\t}\n\n\t/**\n\t * Let the outside world attempt to handle the error.\n\t * The different checkout types can reboot the payment attempt from there.\n\t */\n\treturn defaultHooks.applyFilters( 'payoneer.webSdk.onSdkError', false, sdk, component, data );\n};\n\nexport const onPaymentDeclined = ( sdk, component, data ) => async ( { select, dispatch } ) => {\n\tlog( 'callback: onPaymentDeclined -', component, data );\n\n\treturn defaultHooks.applyFilters( 'payoneer.webSdk.onPaymentDeclined', true, sdk, component, data );\n};\n\nexport const onPaymentFailure = (sdk, component, data) => async ( { select, dispatch } ) => {\n\tlog( 'callback: onPaymentFailure -', component, data );\n\n\treturn defaultHooks.applyFilters( 'payoneer.webSdk.onPaymentFailure', true, sdk, component, data );\n}\n\n/**\n * This callback tells us about the current input-state in a specific checkout component.\n *\n * For Stripe merchants, this callback is instantly fired for _all_ payment methods, once they are\n * fully loaded and usable. This makes the callback a good place to recognize, if a component has\n * finished loading - that's why we set \"isReady\" is true here (and never to false again).\n *\n * For PayFac this callback only fires for the credit card component, and can be used to verify\n * it's ready in the same way. However, other BNPL components (Afterpay) do _not_ trigger this\n * callback, and readiness cannot be detected here.\n */\nexport const onValidationInfo = ( sdk, componentName, data ) => async ( { select, dispatch } ) => {\n\tlog( 'callback: onValidationInfo -', componentName, data );\n\n\tconst normalizedName = normalizeComponentName( componentName, data );\n\tdispatch.setIsValid( normalizedName, data.valid );\n\n\t// The validation-info callback indicates that the component is ready to be used.\n\tdispatch.setIsReady( normalizedName, true );\n};\n\nexport const setActivePaymentMethod = ( method ) => async ( { dispatch } ) => {\n\tlog( 'setActivePaymentMethod -', method );\n\n\tdispatch.mountComponents();\n\tdispatch( { type: ACTIONS.SET_ACTIVE_PAYMENT_METHOD, payload: method } );\n};\n\nexport function setForceHostedFlow( state ) {\n\tlog( 'setForceHostedFlow - override state:', state );\n\treturn { type: ACTIONS.SET_FORCE_HOSTED_FLOW, payload: state };\n}\n\nexport const setOnPaymentUnsuccessfulNonce = ( nonce ) => ( { dispatch } ) => {\n\tdispatch( { type: ACTIONS.SET_ON_PAYMENT_UNSUCCESSFUL_NONCE, payload: nonce } );\n};\n\nexport const setOrderId = ( orderId ) => ( { dispatch } ) => {\n\tdispatch( { type: ACTIONS.SET_ORDER_ID, payload: orderId } );\n};\n\nexport const releaseOnHoldOrder = ( requestData ) => async ( { dispatch } ) => {\n\tlog( 'releaseOnHoldOrder -', requestData );\n\n\tconst targetUrlBase = window.wc_checkout_params.wc_ajax_url.toString().replace( '%%endpoint%%', 'payoneer-checkout-payment-unsuccessful' );\n\tconst separator = targetUrlBase.includes( '?' ) ? '&' : '?';\n\tconst targetUrl = targetUrlBase + separator + '_ajax_nonce=' + window.PayoneerData.onPaymentUnsuccessfulNonce;\n\n\treturn new Promise( ( resolve, reject ) => {\n\t\t$.ajax( {\n\t\t\ttype: 'POST', url: targetUrl, xhrFields: {\n\t\t\t\t// This is important. We need the session cookie to access the LIST in the back-end\n\t\t\t\twithCredentials: true,\n\t\t\t}, data: requestData, dataType: 'json',\n\t\t} ).success( ( data ) => {\n\t\t\t// New nonce for the next request.\n\t\t\tdispatch.setOnPaymentUnsuccessfulNonce( data.nonce );\n\t\t\tresolve( data );\n\t\t} ).catch( ( e ) => {\n\t\t\tconsole.error( e );\n\t\t\treject( e );\n\t\t} );\n\t} );\n};\n\n// Component handling.\n\nexport const onComponentListChange = ( sdk, changeInfo ) => async ( { select, dispatch } ) => {\n\tlog( 'callback: onComponentListChange', sdk, changeInfo );\n\n\tchangeInfo.addedComponents.forEach( ( name ) => {\n\t\tdispatch.addComponentToContainer( name );\n\t} );\n\n\tchangeInfo.removedComponents.forEach( ( name ) => {\n\t\tdispatch.removeComponentFromContainer( name );\n\t} );\n};\n\nexport const addComponentToContainer = ( componentName ) =>\n\tasync ( { select, resolveSelect, dispatch } ) => {\n\t\tconst sdk = await resolveSelect.getSdk();\n\n\t\tif ( !sdk.isDroppedIn( componentName ) ) {\n\t\t\ttry {\n\t\t\t\tconst instance = sdk.dropIn( componentName, { hidePaymentButton: true } );\n\t\t\t\tdispatch.registerComponent( componentName, instance );\n\t\t\t} catch ( e ) {\n\t\t\t\tconsole.error( `Failed to drop in component ${componentName}. Error details: ${e}` );\n\t\t\t}\n\t\t}\n\n\t\tconst { instance } = select.getComponentByName( componentName );\n\t\tmountUnknownComponent( componentName, instance, sdk, dispatch );\n\t};\n\nexport const removeComponentFromContainer = ( componentName ) =>\n\tasync ( { select, resolveSelect, dispatch } ) => {\n\t\t// todo: possibly we also need to unmount the component (unmountAndRemoveComponent).\n\t\tdispatch.unregisterComponent( componentName );\n\t};\n\nexport const registerComponent = ( componentName, instance ) => {\n\treturn { type: ACTIONS.ADD_COMPONENT, payload: { componentName, instance } };\n};\n\nexport const unregisterComponent = ( componentName ) => {\n\treturn { type: ACTIONS.REMOVE_COMPONENT, payload: { componentName } };\n};\n\n/**\n * When a React component is displayed for the first time, the SDK needs to mount its dropIn.\n * So they call this function in a useEffect callback.\n * However:\n * If the SDK has been bootstrapped already, and a new method becomes available after\n * checkout field changes we need to instruct the SDK to refetch the list of dropIn components.\n * This is why we call sdk.updateLongId()\n * After that, the onComponentListChange handler should take care of mounting automatically\n *\n * @returns {(function({select: *, resolveSelect: *, dispatch: *}): Promise<void>)|*}\n */\nexport const initPayoneerComponents = () => async ( { select, resolveSelect, dispatch } ) => {\n\tlog( 'initPayoneerComponents' );\n\n\tconst sdk = await resolveSelect.getSdk();\n\tconst longId = await resolveSelect.getLongId();\n\tawait sdk.updateLongId( longId );\n\n\tawait dispatch.mountComponents();\n};\n\nexport const reboot = () => async ( { select, resolveSelect, dispatch } ) => {\n\tlog( 'reboot' );\n\tdispatch.unmountAllComponents();\n\n\tdefaultHooks.doAction( 'payoneer.webSdk.reboot' );\n\twp.data.dispatch( 'wc/store/cart' ).invalidateResolutionForStore();\n\tdispatch.invalidateResolutionForStore();\n\n\tawait dispatch.mountComponents();\n};\n\nexport const mountComponents = () => async ( { select, resolveSelect, dispatch } ) => {\n\tlog( 'mountComponents' );\n\tdispatch.unmountAllComponents();\n\n\tconst sdk = await resolveSelect.getSdk();\n\tconst components = select.getAllComponents();\n\n\tObject.entries( components ).forEach( async ( [ componentName, item ] ) => {\n\t\tmountUnknownComponent( componentName, item.instance, sdk, dispatch );\n\t} );\n};\n\n/**\n * Mount a component which can be either a PayFac or a Stripe component.\n *\n * PayFac components do not expose all callback events that are required by Stripe components\n * as they implement a few methods as \"redirect\" components that have no input or validation.\n * This helper checks, if a mounted component is such a \"redirect\" component - if it is, then\n * it's instantly marked as ready and valid, as there's no iframe to wait for.\n */\nconst mountUnknownComponent = ( componentName, instance, sdk, dispatch ) => {\n\tmountSdkComponent( componentName, instance, sdk );\n\tdispatch.setIsMounted( componentName, true );\n\n\tif ( isRedirectComponent( instance ) ) {\n\t\tlog( 'mark redirect component as valid and ready -', componentName );\n\n\t\tdispatch.setIsReady( componentName, true );\n\t\tdispatch.setIsValid( componentName, true );\n\t}\n};\n\nexport const unmountAllComponents = () => ( { select, dispatch } ) => {\n\tconst components = select.getAllComponents();\n\n\tObject.keys( components ).forEach( ( componentName ) => {\n\t\tdispatch.setIsMounted( componentName, false );\n\t} );\n};\n\nexport const setIsValid = ( componentName, flag ) => {\n\treturn { type: ACTIONS.SET_IS_VALID, payload: { componentName, flag } };\n};\n\nexport const setIsMounted = ( componentName, flag = true ) => {\n\treturn { type: ACTIONS.SET_IS_MOUNTED, payload: { componentName, flag } };\n};\n\nexport const setIsReady = ( componentName, flag ) => {\n\treturn { type: ACTIONS.SET_IS_READY, payload: { componentName, flag } };\n};\n","var __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"apiFetch\"];","import apiFetch from '@wordpress/api-fetch';\nimport { defaultHooks } from '@wordpress/hooks';\nimport { ACTIONS } from './constants';\nimport initializeSdk from '../util/sdk/umdLoader';\n\nconst {\n\twebsdkStyles: styles\n} = PayoneerData;\n\nexport const getSdk = () => async ( { resolveSelect, dispatch } ) => {\n\tconst env = await resolveSelect.getEnv();\n\tconst sdkVersion = await resolveSelect.getSdkVersion();\n\tconst sdkIntegrity = await resolveSelect.getSdkIntegrity();\n\tconst longId = await resolveSelect.getLongId();\n\tconst onBeforeError = async ( sdk, component, data ) => await dispatch.onBeforeError( sdk, component, data );\n\tconst onPaymentDeclined = async ( sdk, component, data ) => await dispatch.onPaymentDeclined( sdk, component, data );\n\tconst onPaymentFailure = async ( sdk, component, data ) => await dispatch.onPaymentFailure( sdk, component, data );\n\tconst onComponentListChange = async ( sdk, changeInfo ) => await dispatch.onComponentListChange( sdk, changeInfo );\n\tconst onValidationInfo = async ( sdk, componentName, data ) => await dispatch.onValidationInfo( sdk, componentName, data );\n\n\tconst sdk = await initializeSdk( {\n\t\tenv,\n\t\tsdkVersion,\n\t\tsdkIntegrity,\n\t\tonBeforeError,\n\t\tonPaymentDeclined,\n\t\tonPaymentFailure,\n\t\tonComponentListChange,\n\t\tonValidationInfo,\n\t\tpreload: [ 'stripe:cards' ],\n\t\tstyles,\n\t\trefetchListBeforeCharge: true,\n\t} );\n\n\tif ( sdk.state === 'LOADING' ) {\n\t\tconst nonLoadingState = async () => {\n\t\t\treturn await new Promise( resolve => {\n\t\t\t\tconst interval = setInterval( () => {\n\t\t\t\t\tif ( sdk.state !== 'LOADING' ) {\n\t\t\t\t\t\tresolve( sdk.state );\n\t\t\t\t\t\tclearInterval( interval );\n\t\t\t\t\t}\n\t\t\t\t}, 1000 );\n\t\t\t} );\n\t\t};\n\t\tawait nonLoadingState();\n\t}\n\n\tawait sdk.updateLongId( longId );\n\tawait dispatch.setForceHostedFlow( false );\n\tawait dispatch.setSdkState( sdk.state );\n\tawait dispatch( { type: ACTIONS.SET_SDK, payload: sdk } );\n};\n/**\n * Perform a Store API call to the cart endpoint where we provide LIST longId and environment\n */\nexport const getExtensionData = () => async ( { dispatch } ) => {\n\n\tconst response = await apiFetch( {\n\t\t/**\n\t\t * /wc/store/v1/cart\n\t\t * is pre-warmed in PHP, so the first API call will always get data produced during\n\t\t * the initial page load.\n\t\t * Here we MUST receive the results of an actual API call.\n\t\t * So we use a custom URL hash to prevent this from happening.\n\t\t */\n\t\tpath: '/wc/store/v1/cart#skipPreloadingMiddleware',\n\t\tmethod: 'GET',\n\t\tcache: 'no-store',\n\t\tparse: false,\n\t} );\n\n\tconst json = await response.json();\n\tconst payoneerExtensionData = json.extensions[ 'payoneer-checkout' ];\n\tconsole.log( 'Payoneer Extension Data: ', payoneerExtensionData );\n\tawait dispatch( { type: ACTIONS.SET_EXTENSION_DATA, payload: payoneerExtensionData } );\n\tdefaultHooks.doAction( 'payoneer.checkout.onReceiveExtensionData', payoneerExtensionData );\n};\n\nexport const getLongId = () => async ( { resolveSelect, dispatch } ) => {\n\tconst extensionData = await resolveSelect.getExtensionData();\n\tawait dispatch( { type: ACTIONS.SET_LONG_ID, payload: extensionData.longId } );\n};\n\nexport const getEnv = () => async ( { resolveSelect, dispatch } ) => {\n\tconst extensionData = await resolveSelect.getExtensionData();\n\tawait dispatch( { type: ACTIONS.SET_ENV, payload: extensionData.environment } );\n};\n\nexport const getSdkVersion = () => async ( { resolveSelect, dispatch } ) => {\n\tconst extensionData = await resolveSelect.getExtensionData();\n\tawait dispatch( { type: ACTIONS.SET_SDK_VERSION, payload: extensionData.sdkVersion } );\n};\n\nexport const getSdkIntegrity = () => async ( { resolveSelect, dispatch } ) => {\n\tconst extensionData = await resolveSelect.getExtensionData();\n\tawait dispatch( { type: ACTIONS.SET_SDK_INTEGRITY, payload: extensionData.sdkIntegrity } );\n};\n","/*\n * Since the WebSDK is not yet available on npm, we asynchronously\n * load the UMD version from the appropriate env whenever the SDK is initialized\n * for the first time.\n */\n\nconst formatUmdUrl = ( env, sdkVersion ) => {\n\t/**\n\t * When the configuration does not provide a pinned version we can omit the script version to\n\t * load the latest version of the SDK.\n\t *\n\t * @type {string}\n\t */\n\tconst scriptVersion = sdkVersion ? `-${sdkVersion}` : '';\n\n\treturn new URL(\n\t\twindow.PayoneerData.webSdkUmdUrlTemplate\n\t\t\t?.replace( '<env>', env )\n\t\t\t?.replace( '<version>', scriptVersion )\n\t);\n};\n\nconst sdkLoader = ( config ) => {\n\tif ( window.Payoneer?.CheckoutWeb ) {\n\t\treturn window.Payoneer.CheckoutWeb( config );\n\t}\n\n\treturn new Promise( ( resolve, reject ) => {\n\t\tconst script = document.createElement( 'script' );\n\t\tscript.src = formatUmdUrl( config.env, config.sdkVersion );\n\t\tscript.onload = resolve;\n\t\tscript.onerror = reject;\n\n\t\t/**\n\t\t * Add Subresource Integrity (SRI) validation when a specific SDK version is requested.\n\t\t * This enhances security by ensuring the loaded script matches its expected content,\n\t\t * which is a requirement for PCI compliance.\n\t\t */\n\t\tif ( config.sdkVersion && config.sdkIntegrity ) {\n\t\t\tscript.integrity = config.sdkIntegrity;\n\n\t\t\t// Add crossorigin attribute when using integrity checks.\n\t\t\t// This is required for SRI to work properly with CORS.\n\t\t\tscript.crossOrigin = 'anonymous';\n\t\t}\n\t\tdocument.head.appendChild( script );\n\t} ).then( () => {\n\t\treturn window.Payoneer.CheckoutWeb( config );\n\t} );\n};\n\nexport default sdkLoader;\n","import { getComponentNameByGatewayId } from '../util/components';\n\nconst selectors = {\n\t/**\n\t * This is technically only needed temporarily to lazy-fetch longId and env\n\t * in a resolver. Maybe there are better ways to deal with this?\n\t */\n\tgetExtensionData: ( state ) => state.extension,\n\tgetLongId: ( state ) => state.longId,\n\tgetEnv: ( state ) => state.env,\n\tgetSdkVersion: ( state ) => state.sdkVersion,\n\tgetSdkIntegrity: ( state ) => state.sdkIntegrity,\n\tgetSdk: ( state ) => state.sdk,\n\tisHostedModeForced: ( state ) => state.forceHostedFlow,\n\tgetActivePaymentMethod: ( state ) => state.activePaymentMethod,\n\tgetOrderId: ( state ) => state.orderId,\n\tgetOnPaymentUnsuccessfulNonce: ( state ) => state.onPaymentUnsuccessfulNonce,\n\n\t// Component handling.\n\n\tgetAllComponents: ( state ) => state.components,\n\tgetComponentByName: ( state, componentName ) => state.components[ componentName ] ?? {},\n\tgetActiveComponent: ( state ) => {\n\t\tconst componentName = getComponentNameByGatewayId( state.activePaymentMethod );\n\t\treturn state.components[ componentName ] ?? {};\n\t},\n};\n\nexport default selectors;\n","import { createReduxStore, register } from '@wordpress/data';\nimport reducer from './reducer';\nimport * as actions from './actions';\nimport * as resolvers from './resolvers';\nimport selectors from './selectors';\n\nexport const PAYONEER_STORE_KEY = 'payoneer-checkout';\n\nexport const payoneerStore = createReduxStore( PAYONEER_STORE_KEY, {\n\treducer,\n\tactions,\n\tselectors,\n\tresolvers\n} );\n\nregister( payoneerStore );\n\n","import { PAYONEER_STORE_KEY } from \"../store/index\";\nimport { select } from '@wordpress/data';\nimport { isPayForOrder } from \"./woocommerce\";\nimport { defaultHooks } from \"@wordpress/hooks\";\n\nconst FORCE_HOSTED_MODE_HEADER = 'x-payoneer-checkout-force-hosted-flow'\nconst LIST_LONG_ID = 'x-payoneer-long-id'\nconst IS_PAYMENT_CHECKOUT = 'x-payoneer-is-payment-checkout'\n\nconst paymentCheckoutHeaderValue = () => {\n\tif ( !isPayForOrder ) {\n\t\treturn '' // to avoid receiving random variables from non-payment pages\n\t}\n\tconst urlParams = new URLSearchParams( window.location.search );\n\treturn urlParams.get( 'key' ) || '';\n};\n\nconst getCustomHeaders = () => {\n\tconst customHeaders = {\n\t\t[ FORCE_HOSTED_MODE_HEADER ]: String( select( PAYONEER_STORE_KEY ).isHostedModeForced() ),\n\t\t[ IS_PAYMENT_CHECKOUT ]: paymentCheckoutHeaderValue()\n\t};\n\treturn defaultHooks.applyFilters( 'payoneer.http.customHeaders', customHeaders );\n};\n\n/**\n * Since we need the getLongId resolver to have run once, we defer adding the header\n */\ndefaultHooks.addAction(\n\t'payoneer.checkout.onReceiveExtensionData',\n\t'payoneer/setupCustomHttpHeaders',\n\t() => {\n\t\tdefaultHooks.addFilter(\n\t\t\t'payoneer.http.customHeaders',\n\t\t\t'payoneer/setupCustomHttpHeaders',\n\t\t\tfunction ( headers ) {\n\t\t\t\theaders[ LIST_LONG_ID ] = String( select( PAYONEER_STORE_KEY ).getLongId() )\n\t\t\t\treturn headers;\n\t\t\t}\n\t\t)\n\t} );\n\n/**\n * We decorate the global fetch function so that we can pass custom headers for outgoing requests.\n * This is used to control the hosted mode fallback in the back-end and for validating\n * that the frontend LIST longId matches the one used by the backend\n */\nexport const setupCustomHttpHeaders = async () => {\n\n\tconst originalFetch = window.fetch;\n\n\twindow.fetch = async ( ...args ) => {\n\t\tlet [ url, options ] = args;\n\t\t// Only process requests going out to the same origin\n\t\tif ( new URL( url, window.location.origin ).origin !== window.location.origin ) {\n\t\t\treturn originalFetch( url, options );\n\t\t}\n\t\tconst customHeaders = getCustomHeaders();\n\t\tconsole.log( 'Adding custom headers to fetch call', customHeaders );\n\t\t// Clone the original options to avoid mutating it\n\t\tif ( options && options.headers ) {\n\t\t\toptions = { ...options, headers: { ...options.headers, ...customHeaders } };\n\t\t} else {\n\t\t\toptions = { ...options, headers: customHeaders };\n\t\t}\n\n\t\treturn await originalFetch( url, options );\n\t};\n\n\tif ( !window.XMLHttpRequest ) {\n\t\treturn;\n\t}\n\n\tconst originalOpen = XMLHttpRequest.prototype.open;\n\tconst originalSend = XMLHttpRequest.prototype.send;\n\n\tXMLHttpRequest.prototype.open = function ( method, url, ...rest ) {\n\t\tthis._isSameOrigin = new URL( url, window.location.origin ).origin === window.location.origin;\n\t\toriginalOpen.apply( this, [ method, url, ...rest ] );\n\t};\n\n\tXMLHttpRequest.prototype.send = function ( ...args ) {\n\t\tconst customHeaders = getCustomHeaders();\n\n\t\tif ( this._isSameOrigin ) {\n\t\t\tconsole.log( 'Adding custom headers to XMLHttpRequest call', customHeaders );\n\t\t\tfor ( const [ header, value ] of Object.entries( customHeaders ) ) {\n\t\t\t\tthis.setRequestHeader( header, value );\n\t\t\t}\n\t\t}\n\t\toriginalSend.apply( this, args );\n\t};\n}\n","var __WEBPACK_NAMESPACE_OBJECT__ = window[\"wc\"][\"wcBlocksData\"];","import { dispatch } from '@wordpress/data';\nimport { PAYMENT_STORE_KEY } from '@woocommerce/block-data';\nimport { select, subscribe } from '@wordpress/data';\nimport { defaultHooks } from '@wordpress/hooks';\nimport { PAYONEER_STORE_KEY } from './index';\nimport { paymentMethodName } from '../util/woocommerce';\n\nexport const setUpBlockCheckoutListeners = () => {\n\tlet currentPaymentMethod;\n\n\tconst wcPaymentStore = select( PAYMENT_STORE_KEY );\n\tconst paymentStoreCallback = () => {\n\t\tconst paymentMethod = wcPaymentStore.getActivePaymentMethod();\n\t\tif ( currentPaymentMethod !== paymentMethod ) {\n\t\t\tdispatch( PAYONEER_STORE_KEY ).setActivePaymentMethod( paymentMethod );\n\t\t\tcurrentPaymentMethod = paymentMethod;\n\t\t}\n\t};\n\n\tconst unsubscribePaymentStore = subscribe( paymentStoreCallback, PAYMENT_STORE_KEY );\n\tpaymentStoreCallback();\n\n\treturn { unsubscribePaymentStore };\n};\n\nexport const setupClassicCheckoutListeners = () => {\n\tconst paymentMethodCallback = function () {\n\t\tconst methodName = paymentMethodName();\n\t\tdispatch( PAYONEER_STORE_KEY ).setActivePaymentMethod( methodName );\n\t};\n\n\tjQuery( document.body ).on( 'payment_method_selected', paymentMethodCallback );\n\tpaymentMethodCallback();\n\tsetupComponentObserver();\n};\n\n/**\n * Sets up a redux observer that monitors the state of the \"activeComponent\"\n * and fires an action whenever that component changes.\n *\n * The hook is fired only when the component became stable (no change for a\n * given time) and also fires when selecting a non-Payoneer component, or\n * coming back from non-Payoneer to a Payoneer payment method.\n */\nconst setupComponentObserver = () => {\n\tconst OBSERVED_PROPERTIES = [ 'key', 'isValid', 'isMounted', 'isReady' ];\n\tconst DELAY_UNTIL_STABLE = 25;\n\tconst MAX_STABILIZE_ATTEMPTS = 10;\n\n\tconst store = select( PAYONEER_STORE_KEY );\n\tconst knownState = {};\n\tlet waitingTimer = null;\n\n\tconst log = ( ...args ) => console.log( '[componentObserver]', ...args );\n\n\tconst initializeState = ( active ) =>\n\t\tOBSERVED_PROPERTIES.forEach( prop => knownState[ prop ] = null );\n\n\tconst hasStateChanged = ( active ) =>\n\t\tOBSERVED_PROPERTIES.some( prop => knownState[ prop ] !== active[ prop ] );\n\n\tconst updateKnownState = ( active ) =>\n\t\tOBSERVED_PROPERTIES.forEach( prop => knownState[ prop ] = active[ prop ] );\n\n\tconst didComponentChange = () => {\n\t\tconst component = store.getActiveComponent();\n\n\t\tif ( hasStateChanged( component ) ) {\n\t\t\tupdateKnownState( component );\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t};\n\n\tconst waitForStableComponent = ( attempt ) => {\n\t\tconst didChange = didComponentChange();\n\n\t\tif ( !didChange && 0 === attempt ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( didChange && attempt < MAX_STABILIZE_ATTEMPTS ) {\n\t\t\twaitingTimer = setTimeout( waitForStableComponent, DELAY_UNTIL_STABLE, attempt + 1 );\n\t\t\treturn;\n\t\t}\n\n\t\tlog( 'active payment component changed -', knownState );\n\n\t\t/**\n\t\t * Workaround to unblock Klarna, since it does not fire the onValidationInfo callback.\n\t\t *\n\t\t * When the shop currency is EURO, and the country is non-US (e.g. Austria), then selecting\n\t\t * Klarna causes endless spinner on checkout page. This trick unblocks checkout in 3 seconds\n\t\t * so that customer can select another payment method.\n\t\t *\n\t\t * @todo: remove this workaround when the problem is fixed on the Payoneer side. If there\n\t\t *              was any problem with the payment method, we need an event to do something\n\t\t *              about the problem.\n \t\t */\n\t\tif ( 'klarna' === knownState?.key ) {\n\t\t\tsetTimeout(\n\t\t\t\t() => dispatch( PAYONEER_STORE_KEY ).setIsReady( knownState.key, true ),\n\t\t\t\t3000\n\t\t\t);\n\t\t};\n\n\t\t/**\n\t\t * This action fires when the *observed properties* of the active\n\t\t * payment component changed, and the state is stable (no change\n\t\t * for a given time; important during mounting/initialization).\n\t\t *\n\t\t * When a non-Payoneer component is selected, then all properties\n\t\t * are set to `undefined`. This ensures that the action also fires\n\t\t * once when switching from a Payoneer component to another payment\n\t\t * method.\n\t\t */\n\t\tdefaultHooks.doAction( 'payoneer.checkout.paymentMethodChanged', { ...knownState } );\n\t\twaitingTimer = null;\n\t};\n\n\tconst observeActiveComponent = () => {\n\t\tif ( waitingTimer !== null ) {\n\t\t\t// Early return if we are already waiting for a stable state.\n\t\t\treturn;\n\t\t}\n\n\t\twaitForStableComponent( 0 );\n\t};\n\n\tlog( 'subscribe to store changes' );\n\tinitializeState();\n\tconst unsubscribe = subscribe( observeActiveComponent, PAYONEER_STORE_KEY );\n\n\treturn { unsubscribe };\n};\n","import $ from 'jquery';\nimport { select } from '@wordpress/data';\nimport { isPayoneerGatewaySelected } from './woocommerce';\nimport { PAYONEER_STORE_KEY } from '../store';\n\n/**\n * Default selector that identifies the container of the \"Place Order\" button on the\n * Classic Checkout page.\n */\nconst DEFAULT_SELECTOR = '.form-row.place-order';\nconst BUTTON_SELECTOR = '#place_order';\n\nconst BODY_CLASS_STATE_READY = 'payoneer-checkout-payment-allowed';\nconst BODY_CLASS_STATE_INVALID = 'payoneer-checkout-payment-data-invalid';\nconst BODY_CLASS_STATE_PROCESSING = 'payoneer-checkout-payment-not-ready';\n\n/**\n * Manages the checkout's \"Place Order\" section state with different blocking strategies:\n *\n * 1) BLOCK the Place Order button while components are loading (with spinner).\n *     Prevent WooCommerce from creating \"on-hold\" orders due to missing payment details.\n *\n * 2) BLOCK the button after it was clicked - unblock it again on error (with spinner).\n *     Prevent WooCommerce from creating duplicate orders for the same transaction.\n *\n * 3) DISABLE the button when payment form input is invalid (no spinner).\n *     Prevent buyers from clicking the button until they completed the payment form.\n *\n * Dependency from WooCommerce:\n *   We use `$.fn.block()` and `$.fn.unblock()` methods provided by the \"jQuery blockUI plugin\"\n *   plugin, which is part of the WooCommerce core. This aligns with the approach taken by\n *   WooCommerce, and will display the familiar spinner animation while the button is blocked.\n */\nclass OrderPlacementManager {\n\t#selector = '';\n\t#blockingStyleElement = null;\n\t#message = null;\n\t#state = {\n\t\t/**\n\t\t * Control the state of this manager. When not active, it does not\n\t\t * block or disable the payment button.\n\t\t */\n\t\tactive: true,\n\n\t\t/**\n\t\t * Set via API method to indicate a background activity is processing.\n\t\t * While processing: A spinner is displayed.\n\t\t */\n\t\tprocessing: false,\n\n\t\t/**\n\t\t * Set via API method to indicate payment form contains valid input.\n\t\t * While invalid: Button is disabled.\n\t\t */\n\t\tvalid: false,\n\t};\n\n\tconstructor( selector = DEFAULT_SELECTOR ) {\n\t\tthis.#selector = selector;\n\t\tthis.#log( `initialized` );\n\t\tthis.#updateDomState();\n\t}\n\n\t/**\n\t * Get the current \"Place Order\" area element (fresh DOM query each time)\n\t */\n\tget area() {\n\t\treturn $( this.#selector );\n\t}\n\n\t/**\n\t * Get the \"Place Order\" button element.\n\t */\n\tget button() {\n\t\treturn this.area.find( BUTTON_SELECTOR );\n\t}\n\n\t/**\n\t * Check if payment should be allowed based on all conditions\n\t */\n\tget isPaymentAllowed() {\n\t\tconst { active, valid, processing } = this.#state;\n\t\treturn !active || ( valid && !processing );\n\t}\n\n\t/**\n\t * Check if checkout is blocked with a spinner.\n\t * @depends on jquery.blockUI.js\n\t */\n\tget isAreaBlocked() {\n\t\t// Managed by the \"jQuery blockUI plugin\" plugin. Value can be 1/0/undefined.\n\t\treturn !!this.area.data( 'blockUI.isBlocked' );\n\t}\n\n\t/**\n\t * Check if the payment button is currently disabled.\n\t */\n\tget isButtonDisabled() {\n\t\treturn this.button.prop( 'disabled' );\n\t}\n\n\t/**\n\t * Checks if the payment form input is valid.\n\t */\n\tget validPaymentInput() {\n\t\treturn this.#state.valid;\n\t}\n\n\t/**\n\t * Marks the payment form input as valid or invalid.\n\t */\n\tsetValidInput( isValid ) {\n\t\tthis.#state.valid = isValid;\n\t\tthis.#updateDomState();\n\t}\n\n\t/**\n\t * Changes the \"background process\" state. An active background process\n\t * locks the payment button behind a spinner.\n\t */\n\tsetProcessing( processing = true ) {\n\t\tif ( !processing ) {\n\t\t\tthis.#message = null;\n\t\t\tthis.#state.processing = false;\n\t\t} else {\n\t\t\tthis.#state.processing = true;\n\t\t}\n\n\t\tthis.#updateDomState();\n\t}\n\n\tsetProcessingMessage( message ) {\n\t\tthis.#message = message;\n\t\tthis.#updateDomState();\n\t}\n\n\tsetActive( state ) {\n\t\tthis.#state.active = state;\n\t\tthis.#updateDomState();\n\t}\n\n\t/**\n\t * Update DOM state based on current conditions\n\t * @private\n\t */\n\t#updateDomState() {\n\t\tconst { active, valid, processing } = this.#state;\n\n\t\tif ( !active ) {\n\t\t\tthis.#unblockArea();\n\t\t\tthis.#enableButton();\n\t\t\tthis.#setBodyClass( null );\n\t\t\treturn;\n\t\t}\n\n\t\t// BLOCK AREA: When components loading or processing (user waits)\n\t\tif ( processing ) {\n\t\t\tthis.#setBodyClass( BODY_CLASS_STATE_PROCESSING );\n\t\t\tthis.#blockArea();\n\t\t\treturn;\n\t\t}\n\n\t\t// UNBLOCK AREA: Components ready and not processing\n\t\tthis.#unblockArea();\n\n\t\t// DISABLE BUTTON: When input invalid (user can fix form)\n\t\tif ( !valid ) {\n\t\t\tthis.#setBodyClass( BODY_CLASS_STATE_INVALID );\n\t\t\tthis.#disableButton();\n\t\t} else {\n\t\t\tthis.#setBodyClass( BODY_CLASS_STATE_READY );\n\t\t\tthis.#enableButton();\n\t\t}\n\t}\n\n\t#setBodyClass( newClass ) {\n\t\tconst STATES = [\n\t\t\tBODY_CLASS_STATE_READY,\n\t\t\tBODY_CLASS_STATE_INVALID,\n\t\t\tBODY_CLASS_STATE_PROCESSING,\n\t\t];\n\n\t\tSTATES.forEach( state => {\n\t\t\tdocument.body.classList.remove( state );\n\t\t} );\n\n\t\tif ( newClass && STATES.includes( newClass ) ) {\n\t\t\tdocument.body.classList.add( newClass );\n\t\t}\n\t}\n\n\t/**\n\t * Block the entire area with spinner\n\t * @depends on jquery.blockUI.js\n\t * @private\n\t */\n\t#blockArea() {\n\t\tif ( 'function' !== typeof $.fn.block ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst args = {\n\t\t\tmessage: this.#message,\n\t\t\toverlayCSS: {\n\t\t\t\tbackground: '#fff',\n\t\t\t\topacity: 0.6,\n\t\t\t}\n\t\t};\n\n\t\t// Customize the overlay when it contains a message/HTML elements.\n\t\tif ( this.#message ) {\n\t\t\targs.blockMsgClass = 'no-spinner';\n\t\t\targs.css = {\n\t\t\t\tmaxWidth: '80%',\n\t\t\t\twidth: 'auto',\n\t\t\t\tcursor: 'default',\n\t\t\t};\n\t\t}\n\n\t\t// No animation if we only update the blockUI overlay.\n\t\tif ( this.isAreaBlocked ) {\n\t\t\targs.fadeIn = 0;\n\t\t}\n\n\t\tthis.#injectBlockingCSS();\n\t\tthis.area.block( args );\n\n\t\tthis.#log( ' area blocked (spinner)' );\n\t}\n\n\t/**\n\t * Unblock the area\n\t * @depends on jquery.blockUI.js\n\t * @private\n\t */\n\t#unblockArea() {\n\t\tif ( !this.isAreaBlocked || 'function' !== typeof $.fn.unblock ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#removeBlockingCSS();\n\t\tthis.area.unblock();\n\t\tthis.#log( ' area unblocked' );\n\t}\n\n\t/**\n\t * Disable just the button\n\t * @private\n\t */\n\t#disableButton() {\n\t\tif ( this.isButtonDisabled ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.button.prop( 'disabled', true ).addClass( 'disabled' );\n\t\tthis.#log( ' button disabled' );\n\t}\n\n\t/**\n\t * Enable the button\n\t * @private\n\t */\n\t#enableButton() {\n\t\tif ( !this.isButtonDisabled ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.button.prop( 'disabled', false ).removeClass( 'disabled' );\n\t\tthis.#log( ' button enabled' );\n\t}\n\n\t/**\n\t * Inject CSS to disable area interactions\n\t * @private\n\t */\n\t#injectBlockingCSS() {\n\t\tif ( this.#blockingStyleElement ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#blockingStyleElement = document.createElement( 'style' );\n\t\tthis.#blockingStyleElement.textContent = this.#getBlockingCSS();\n\n\t\tdocument.head.appendChild( this.#blockingStyleElement );\n\t\tthis.#log( ' blocking CSS injected' );\n\t}\n\n\t/**\n\t * Remove injected blocking CSS\n\t * @private\n\t */\n\t#removeBlockingCSS() {\n\t\tif ( !this.#blockingStyleElement ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#blockingStyleElement.remove();\n\t\tthis.#blockingStyleElement = null;\n\t\tthis.#log( ' blocking CSS removed' );\n\t}\n\n\t/**\n\t * Generate CSS rules for blocking the \"Pay\" button on browser-level.\n\t * These rules are used during the early page load phase, while the SDK is still loading.\n\t * @private\n\t */\n\t#getBlockingCSS() {\n\t\tconst baseSelector = this.#selector;\n\n\t\treturn `\n\t\t\t${baseSelector} .place-order {\n\t\t\t\tpointer-events: none !important;\n\t\t\t}\n\t\t\t${baseSelector} #place_order {\n\t\t\t\topacity: 0.5 !important;\n\t\t\t\tpointer-events: none !important;\n\t\t\t}\n\t\t\t.blockUI.no-spinner:before {\n\t\t\t\tdisplay: none !important;\n\t\t\t}\n\t\t\t.blockUI.no-spinner button {\n\t\t\t\tdisplay: block;\n\t\t\t\twidth: 100%;\n\t\t\t}\n\t\t`;\n\t}\n\n\t/**\n\t * Log with consistent formatting and state visibility\n\t * @private\n\t */\n\t#log( message ) {\n\t\tconst { active, valid, processing } = this.#state;\n\t\tconsole.log( `[OrderPlacement] ${message} | A:${active} V:${valid} P:${processing}` );\n\t}\n}\n\nexport default OrderPlacementManager;\n","import $ from 'jquery';\nimport { defaultHooks } from '@wordpress/hooks';\nimport { select, dispatch } from '@wordpress/data';\nimport {\n\tisPayoneerGatewaySelected,\n\tfocusOnSelectedGateway\n} from '../woocommerce';\nimport { PAYONEER_STORE_KEY } from '../../store';\nimport { setupClassicCheckoutListeners } from '../../store/storeListeners';\nimport OrderPlacementManager from '../OrderPlacementManager';\n\nconst log = ( ...args ) => console.log( '[classic checkout]', ...args );\n\nconst initPayoneerComponents = () => dispatch( PAYONEER_STORE_KEY ).initPayoneerComponents();\nconst payWithPayoneer = () => dispatch( PAYONEER_STORE_KEY ).pay();\nconst rebootPayoneer = () => dispatch( PAYONEER_STORE_KEY ).reboot();\nconst setOnPaymentUnsuccessfulNonce = () => dispatch( PAYONEER_STORE_KEY ).setOnPaymentUnsuccessfulNonce();\nconst releaseOnHoldOrder = ( requestData ) => dispatch( PAYONEER_STORE_KEY ).releaseOnHoldOrder( requestData );\nconst payoneerStore = select( PAYONEER_STORE_KEY );\n\nexport const initClassicCheckout = () => {\n\tlog( 'init' );\n\n\tconst orderPlacementManager = new OrderPlacementManager( '#payment' );\n\n\t/**\n\t * Set up hooks before everything else to ensure that we already capture\n\t * actions that are fired during the following setup steps.\n\t */\n\n\tdefaultHooks.addAction(\n\t\t'payoneer.checkout.paymentMethodChanged',\n\t\t'payoneer/shortcodeCheckout',\n\t\t( { key, isValid, isReady } ) => {\n\t\t\tlog( 'hook paymentMethodChanged' );\n\n\t\t\tif ( !key && !isPayoneerGatewaySelected() ) {\n\t\t\t\t// The method name is only set when a payoneer component is active.\n\t\t\t\torderPlacementManager.setActive( false );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\torderPlacementManager.setActive( true );\n\t\t\torderPlacementManager.setProcessing( !isReady );\n\t\t\torderPlacementManager.setValidInput( isValid );\n\t\t}\n\t);\n\n\tconst $cancelButton = $( '<button type=\"button\" />' )\n\t\t.text( 'Cancel Payment' )\n\t\t.on( 'click', () => {\n\t\t\t// Hide the button and display the spinner.\n\t\t\torderPlacementManager.setProcessingMessage( null );\n\n\t\t\treleaseOnHoldOrder( { longId: payoneerStore.getLongId() } )\n\t\t\t\t.then( () => window.location.reload() );\n\t\t} );\n\n\tconst showCancelButton = ( paymentMethod ) => {\n\t\tif ( 'cards' === paymentMethod ) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet testCancelButton = false;\n\t\ttry {\n\t\t\t// Enable cancel button (unstable): localStorage.setItem( 'testCancelButton', true );\n\t\t\ttestCancelButton = localStorage.getItem( 'testCancelButton' );\n\t\t} catch ( e ) {\n\t\t}\n\n\t\tif ( !testCancelButton ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Replace the spinner with a cancel button, after a short delay.\n\t\tsetTimeout( () => orderPlacementManager.setProcessingMessage( $cancelButton ), 2000 );\n\t\t// Hide the cancel button after 57 seconds, because the payment auto-completes after 60 seconds.\n\t\tsetTimeout( () => orderPlacementManager.setProcessingMessage( null ), 57000 );\n\t};\n\n\tdocument.addEventListener(\n\t\t'DOMContentLoaded',\n\t\t() => {\n\t\t\tlog( 'dom ready, setup listeners' );\n\n\t\t\tsetupClassicCheckoutListeners();\n\t\t\tsetOnPaymentUnsuccessfulNonce( PayoneerData.onPaymentUnsuccessfulNonce );\n\n\t\t\tconst $checkoutForm = $( 'form.checkout' );\n\n\t\t\tdefaultHooks.addFilter(\n\t\t\t\t'payoneer.webSdk.onSdkError',\n\t\t\t\t'payoneer/shortcodeCheckout',\n\t\t\t\t( isResolved, checkout, component, data ) => {\n\t\t\t\t\tlog( 'hook onSdkError', { isResolved, data } );\n\n\t\t\t\t\trebootPayoneer();\n\n\t\t\t\t\t$( document.body ).trigger( 'update_checkout' );\n\t\t\t\t\treturn isResolved;\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tdefaultHooks.addFilter(\n\t\t\t\t'payoneer.webSdk.onPaymentDeclined',\n\t\t\t\t'payoneer/shortcodeCheckout',\n\t\t\t\t(continueDefaultErrorHandling, sdk, componentName, responseData ) => {\n\t\t\t\t\tlog( 'hook onPaymentDeclined' );\n\n\t\t\t\t\thandleUnsuccessfulPayment(responseData, 'declined');\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tdefaultHooks.addFilter(\n\t\t\t\t'payoneer.webSdk.onPaymentFailure',\n\t\t\t\t'payoneer/shortcodeCheckout',\n\t\t\t\t(continueDefaultErrorHandling, sdk, componentName, responseData ) => {\n\t\t\t\t\tlog( 'hook onPaymentFailure' );\n\n\t\t\t\t\thandleUnsuccessfulPayment(responseData, 'failure');\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t);\n\n\t\t\t/**\n\t\t\t * Cannot use native event listener for events dispatched by jQuery\n\t\t\t * https://github.com/jquery/jquery/issues/3347\n\t\t\t */\n\t\t\t$( document.body ).on( 'updated_checkout', () => {\n\t\t\t\tlog( 'event updated_checkout' );\n\n\t\t\t\tinitPayoneerComponents();\n\t\t\t} );\n\n\t\t\t$checkoutForm.on( 'checkout_place_order', ( e ) => {\n\t\t\t\tlog( 'event checkout_place_order' );\n\n\t\t\t\tif ( !isPayoneerGatewaySelected() || payoneerStore.isHostedModeForced() ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Prevent submission if blocked\n\t\t\t\tif ( !orderPlacementManager.isPaymentAllowed ) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\tlog( 'checkout submission prevented - payment not allowed in current state' );\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst { isValid, isReady } = payoneerStore.getActiveComponent();\n\n\t\t\t\tif ( !isReady || !isValid ) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tfocusOnSelectedGateway();\n\t\t\t\t\t} catch ( error ) {\n\t\t\t\t\t\tconsole.error( error );\n\t\t\t\t\t}\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\t// Block the button before submitting the form.\n\t\t\t\torderPlacementManager.setProcessing( true );\n\n\t\t\t\treturn true;\n\t\t\t} );\n\n\t\t\t$checkoutForm.on( 'checkout_place_order_success', ( e, result ) => {\n\t\t\t\tlog( 'event checkout_place_order_success' );\n\n\t\t\t\tif ( !isPayoneerGatewaySelected() || payoneerStore.isHostedModeForced() ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst { key } = payoneerStore.getActiveComponent();\n\n\t\t\t\tpayWithPayoneer();\n\t\t\t\tshowCancelButton( key );\n\n\t\t\t\t// Override default redirect to hosted payment page.\n\t\t\t\tresult.redirect = '#payoneer-redirect';\n\n\t\t\t\treturn false;\n\t\t\t} );\n\n\t\t\t// Force allow payment on checkout errors (bypass component state)\n\t\t\t$( document.body ).on( 'checkout_error', ( event, msg ) => {\n\t\t\t\tif ( msg && msg.includes( 'data-payment-state=\"pending\"' ) ) {\n\t\t\t\t\t/**\n\t\t\t\t\t * This is not a checkout error, but a workaround for WooCommerce:\n\t\t\t\t\t *\n\t\t\t\t\t * The order was created on server side, but the payment was not completed yet.\n\t\t\t\t\t * Since the Woo-flow expects synchronous payments, we signal \"success\" as API\n\t\t\t\t\t * response, but our `checkout_place_order_success` handler returns false,\n\t\t\t\t\t * leaving WooCommerce with mixed signals, and triggering this \"faux-error\".\n\t\t\t\t\t * We can ignore it, as payment is currently processing via the WebSDK.\n\t\t\t\t\t */\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlog( 'event checkout_error' );\n\n\t\t\t\torderPlacementManager.setProcessing( false );\n\t\t\t} );\n\t\t},\n\t\tfalse\n\t);\n\n\tconst handleUnsuccessfulPayment = ( responseData, paymentResult ) => {\n\t\treleaseOnHoldOrder( {\n\t\t\tlongId: payoneerStore.getLongId(),\n\t\t\terrorTitleToDisplay: responseData.interaction?.customerMessage?.title ?? 'Payment failed',\n\t\t\terrorTextToDisplay: responseData.interaction?.customerMessage?.text ?? 'Please try again.',\n\t\t\tpaymentResult\n\t\t} ).finally( () => {\n\t\t\t// Always unblock after payment decline is handled.\n\t\t\torderPlacementManager.setProcessing( false );\n\t\t\t$( document.body ).trigger( 'update_checkout' );\n\t\t} );\n\t}\n};\n","import { useEffect } from 'react';\nimport { dispatch } from '@wordpress/data';\nimport { PAYONEER_STORE_KEY } from '../../store/index';\n\n/**\n * @see https://developer.woocommerce.com/2022/10/06/how-the-checkout-block-processes-an-order/\n * @see https://developer.woocommerce.com/docs/cart-and-checkout-payment-method-integration-for-the-checkout-block/#3-props-fed-to-payment-method-nodes\n */\nexport const Component = function (\n\t{\n\t\tactivePaymentMethod,\n\t\teventRegistration,\n\t\tcomponentName,\n\t\tpaymentMethodData,\n\t\tcanMakePayment,\n\t\tinitPayoneerComponents,\n\t\trebootPayoneer,\n\t\tpayWithPayoneer,\n\t}\n) {\n\tconst { onPaymentSetup, onCheckoutSuccess, onCheckoutFail } = eventRegistration;\n\n\t/**\n\t * Ping the SDK when we see the light of day\n\t */\n\tuseEffect( () => {\n\t\tinitPayoneerComponents();\n\t}, [] );\n\n\tuseEffect( () => {\n\t\treturn onCheckoutSuccess( ( { orderId } ) => {\n\t\t\tdispatch( PAYONEER_STORE_KEY ).setOrderId( orderId );\n\t\t\tpayWithPayoneer();\n\t\t} );\n\t}, [] );\n\n\tuseEffect( () => {\n\t\treturn onCheckoutFail( rebootPayoneer );\n\t}, [] );\n\n\t/**\n\t * Enhance the payment data validation step.\n\t * We need to validate that the LIST used in block checkout submit\n\t * matches the one we will use for finalizing the transaction in the backend.\n\t * Therefore, we pass additional metadata in this listener\n\t */\n\tuseEffect( () => {\n\t\treturn onPaymentSetup( () => {\n\t\t\tif ( canMakePayment ) {\n\t\t\t\treturn { type: 'success' };\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttype: 'failure',\n\t\t\t\tmessage: 'Invalid payment fields',\n\t\t\t};\n\t\t} );\n\t}, [ canMakePayment, onPaymentSetup, paymentMethodData ] );\n\n\treturn <div\n\t\tclassName={`payment_method_${activePaymentMethod}`}\n\t\tdata-component={componentName}\n\t></div>;\n};\n","import { dispatch, withSelect } from '@wordpress/data';\nimport { PAYONEER_STORE_KEY } from '../../store';\nimport { getComponentNameByGatewayId } from '../../util/components';\n\nconst initPayoneerComponents = () => dispatch( PAYONEER_STORE_KEY ).initPayoneerComponents();\nconst payWithPayoneer = () => dispatch( PAYONEER_STORE_KEY ).pay();\nconst rebootPayoneer = () => dispatch( PAYONEER_STORE_KEY ).reboot();\n\n/**\n * Higher-Order Component that maps the inner component's props to our payoneer store\n */\nexport const provider = withSelect(\n\t( select, ownProps ) => {\n\t\tconst payoneer = select( PAYONEER_STORE_KEY );\n\t\tconst {\n\t\t\tactivePaymentMethod,\n\t\t\teventRegistration\n\t\t} = ownProps;\n\n\t\tconst componentName = getComponentNameByGatewayId( activePaymentMethod );\n\t\tconst { isValid, isReady } = payoneer.getComponentByName( componentName );\n\n\t\treturn {\n\t\t\tactivePaymentMethod,\n\t\t\teventRegistration,\n\n\t\t\t// Custom Payoneer props.\n\t\t\tcanMakePayment: isReady && isValid,\n\t\t\tcomponentName,\n\t\t\tinitPayoneerComponents,\n\t\t\trebootPayoneer,\n\t\t\tpayWithPayoneer,\n\t\t};\n\t}\n);\n","import {Component} from './component'\nimport {provider} from './provider'\n\nexport const WidgetContainer = provider(Component)\n","import $ from 'jquery';\nimport { select, dispatch } from '@wordpress/data';\nimport { setUpBlockCheckoutListeners } from \"../../store/storeListeners\";\nimport { WidgetContainer } from '../../components/widgetContainer';\nimport { PAYONEER_STORE_KEY } from \"../../store/index\";\nimport { getLongId } from \"../../store/resolvers\";\n\nconst payoneerStore = select( PAYONEER_STORE_KEY );\nconst errorMessageStorageKey = 'payoneer-checkout-error-message';\n\nconst setUpGatewayContainers = function () {\n\tif ( !Array.isArray( inpsydeGateways ) ) {\n\t\tconsole.error( 'window.inpsydeGateways not found' );\n\t\treturn;\n\t}\n\n\tinpsydeGateways.forEach( ( gatewayName ) => {\n\t\taddWidgetContainer( gatewayName );\n\t} );\n};\n\nconst addWidgetContainer = function ( gatewayId ) {\n\twp.hooks.addFilter( `${gatewayId}_checkout_fields`, gatewayId, ( components ) => {\n\t\tcomponents.push( WidgetContainer );\n\t\treturn components;\n\t} );\n\n\twp.hooks.addFilter(\n\t\t'payoneer-checkout_payment_method_icons',\n\t\t'payoneer-checkout',\n\t\t( icons ) => {\n\t\t\tconst activePaymentMethod = payoneerStore.getActivePaymentMethod();\n\t\t\treturn activePaymentMethod === 'payoneer-checkout' ? [] : icons;\n\t\t}\n\t);\n};\n\nconst registerPageReloadingOnPaymentUnsuccessful = () => {\n\tdocument.addEventListener(\n\t\t'DOMContentLoaded',\n\t\t() => {\n\t\t\twp.hooks.addFilter(\n\t\t\t\t'payoneer.webSdk.onPaymentDeclined',\n\t\t\t\t'payoneer/blockCheckout',\n\t\t\t\t( continueDefaultErrorHandling, sdk, componentName, responseData ) => {\n\t\t\t\t\thandlePaymentUnsuccessful(responseData, 'declined')\n\t\t\t\t\t//disable error handling with WebSDK to prevent error message from appearing in payment widget\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t);\n\t\t},\n\t\tfalse\n\t);\n\n\tdocument.addEventListener(\n\t\t'DOMContentLoaded',\n\t\t() => {\n\t\t\twp.hooks.addFilter(\n\t\t\t\t'payoneer.webSdk.onPaymentFailure',\n\t\t\t\t'payoneer/blockCheckout',\n\t\t\t\t( continueDefaultErrorHandling, sdk, componentName, responseData ) => {\n\t\t\t\t\thandlePaymentUnsuccessful(responseData, 'failed')\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t);\n\t\t},\n\t\tfalse\n\t);\n\n\tconst handlePaymentUnsuccessful = function ( responseData, paymentResult ) {\n\t\twp.data.dispatch( PAYONEER_STORE_KEY ).releaseOnHoldOrder(\n\t\t\t{\n\t\t\t\tlongId: select( PAYONEER_STORE_KEY ).getLongId(),\n\t\t\t\tpayoneerOrderId: select( PAYONEER_STORE_KEY ).getOrderId(),\n\t\t\t\tpaymentResult\n\t\t\t},\n\t\t);\n\t\t/**\n\t\t * The following is an extreme solution where a correct solution seemingly does not exist.\n\t\t * As of 02/2025, the WooCommerce checkout entirely depends on a redirectUrl after onCheckoutSuccess().\n\t\t * If there is no redirect, core WC will simply do nothing, leaving a nonfunctional checkout page\n\t\t * with a greyed-out blocked Pay button.\n\t\t * You can test this by out-commenting the payment call in our 'onCheckoutSuccess' observer.\n\t\t *\n\t\t * Now:\n\t\t * Our WC backend cannot dictate a redirectUrl because we will only start the client-side CHARGE\n\t\t * after creating the order in the backend. Thus, the backend only finalizes LIST data.\n\t\t * It is the job of the WebSDK to carry out the payment and handle the redirects.\n\t\t * On the happy path, this is not an issue.\n\t\t *\n\t\t * But what if there is an error?\n\t\t * component.pay() is async, but onCheckoutSuccess() can only be influenced synchronously, by returning\n\t\t * success/failure. But we cannot know that since we are not omniscient time-bending 4D creatures yet.\n\t\t *\n\t\t * So since we cannot give WC any meaningful signal before resolving the async call,\n\t\t * we are forced to accept its default behaviour: redirecting to 'redirectUrl' which is empty,\n\t\t * leading to the aforementioned blocked checkout state.\n\t\t *\n\t\t * The only known recovery is dispatch(CHECKOUT_STORE_KEY).__internalSetIdle()\n\t\t * However, that's using an internal function that might be unsafe and could be removed any time.\n\t\t *\n\t\t * So we're picking the heavy tools when they are required. Hints and PRs welcome.\n\t\t *\n\t\t * @see https://developer.woocommerce.com/docs/cart-and-checkout-checkout-flow-and-events/\n\t\t */\n\t\tconst errorMessage = typeof responseData.interaction.customerMessage === 'undefined' ?\n\t\t\t{ title: 'Payment failed', text: 'Please, try again.' } :\n\t\t\tresponseData.interaction.customerMessage;\n\t\twindow.sessionStorage.setItem( errorMessageStorageKey, JSON.stringify( errorMessage ) );\n\t\twindow.location.reload();\n\t}\n}\n\n/**\n * We only need this because we have to reload the payment page on payment decline.\n * We disabled displaying the error message in the payment widget, and storing it instead.\n * After the page is reloaded, we get the message and display it.\n */\nconst displayErrorMessages = function ( ) {\n\tlet errorMessage = window.sessionStorage.getItem( errorMessageStorageKey );\n\tif ( errorMessage ) {\n\t\twindow.sessionStorage.removeItem( errorMessageStorageKey );\n\t\ttry {\n\t\t\t//prepare and add error message\n\t\t\terrorMessage = JSON.parse( errorMessage );\n\t\t\terrorMessage = `<b>${errorMessage.title}</b><br>` + errorMessage.text;\n\t\t\tdispatch( \"core/notices\" ).createErrorNotice(\n\t\t\t\terrorMessage,\n\t\t\t\t{\n\t\t\t\t\tcontext: \"wc/checkout\",\n\t\t\t\t\tisDismissible: false\n\t\t\t\t}\n\t\t\t);\n\t\t\t//scroll to the error message when it is displayed\n\t\t\tlet attempts = 0;\n\t\t\tconst maxAttempts = 20;\n\t\t\tconst interval = setInterval( () => {\n\t\t\t\tattempts++;\n\t\t\t\tif ( attempts >= maxAttempts ) {\n\t\t\t\t\tclearInterval( interval );\n\t\t\t\t\tconsole.warn( \"Couldn't find error message to scroll to.\" );\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst noticeElement = document.querySelector( \".wc-block-components-notice-banner.is-error\" );\n\t\t\t\tif ( noticeElement ) {\n\t\t\t\t\tclearInterval( interval );\n\t\t\t\t\tnoticeElement.scrollIntoView( {\n\t\t\t\t\t\tbehavior: \"smooth\",\n\t\t\t\t\t\tblock: \"start\"\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t}, 500 );\n\n\t\t} catch ( e ) {\n\t\t\tconsole.error( 'Failed to display error message', e );\n\t\t}\n\t}\n};\n\nexport const initBlockCheckout = () => {\n\tconsole.log( 'Loading block checkout integration' );\n\tsetUpBlockCheckoutListeners();\n\tsetUpGatewayContainers();\n\tregisterPageReloadingOnPaymentUnsuccessful();\n\tdisplayErrorMessages();\n}\n","import $ from 'jquery';\nimport { defaultHooks } from '@wordpress/hooks';\nimport { select, dispatch } from '@wordpress/data';\nimport {\n\tisPayoneerGatewaySelected,\n\tsubmitOrderPayViaAjax,\n\tfocusOnSelectedGateway\n} from '../woocommerce';\nimport { PAYONEER_STORE_KEY } from '../../store';\nimport { setupClassicCheckoutListeners } from '../../store/storeListeners';\nimport OrderPlacementManager from '../OrderPlacementManager';\n\nconst log = ( ...args ) => console.log( '[payment page]', ...args );\n\nconst mountComponents = () => dispatch( PAYONEER_STORE_KEY ).mountComponents();\nconst payWithPayoneer = () => dispatch( PAYONEER_STORE_KEY ).pay();\nconst setOnPaymentUnsuccessfulNonce = () => dispatch( PAYONEER_STORE_KEY ).setOnPaymentUnsuccessfulNonce();\nconst releaseOnHoldOrder = ( requestData ) => dispatch( PAYONEER_STORE_KEY ).releaseOnHoldOrder( requestData );\nconst payoneerStore = select( PAYONEER_STORE_KEY );\n\nexport const initPaymentCheckout = () => {\n\tlog( 'init' );\n\n\tconst orderPlacementManager = new OrderPlacementManager( '#payment .form-row' );\n\n\t/**\n\t * Set up hooks before everything else to ensure that we already capture\n\t * actions that are fired during the following setup steps.\n\t */\n\n\tdefaultHooks.addAction(\n\t\t'payoneer.checkout.paymentMethodChanged',\n\t\t'payoneer/shortcodeCheckout',\n\t\t( { key, isValid, isReady } ) => {\n\t\t\tlog( 'hook paymentMethodChanged' );\n\n\t\t\tif ( !key && !isPayoneerGatewaySelected() ) {\n\t\t\t\t// The method name is only set when a payoneer component is active.\n\t\t\t\torderPlacementManager.setActive( false );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\torderPlacementManager.setActive( true );\n\t\t\torderPlacementManager.setProcessing( !isReady );\n\t\t\torderPlacementManager.setValidInput( isValid );\n\t\t}\n\t);\n\n\tconst $cancelButton = $( '<button type=\"button\" />' )\n\t\t.text( 'Cancel Payment' )\n\t\t.on( 'click', () => {\n\t\t\t// Hide the button and display the spinner.\n\t\t\torderPlacementManager.setProcessingMessage( null );\n\n\t\t\treleaseOnHoldOrder( { longId: payoneerStore.getLongId() } )\n\t\t\t\t.then( () => window.location.reload() );\n\t\t} );\n\n\tconst showCancelButton = ( paymentMethod ) => {\n\t\tif ( 'cards' === paymentMethod ) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet testCancelButton = false;\n\t\ttry {\n\t\t\t// Enable cancel button (unstable): localStorage.setItem( 'testCancelButton', true );\n\t\t\ttestCancelButton = localStorage.getItem( 'testCancelButton' );\n\t\t} catch ( e ) {\n\t\t}\n\n\t\tif ( !testCancelButton ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Replace the spinner with a cancel button, after a short delay.\n\t\tsetTimeout( () => orderPlacementManager.setProcessingMessage( $cancelButton ), 2000 );\n\t\t// Hide the cancel button after 57 seconds, because the payment auto-completes after 60 seconds.\n\t\tsetTimeout( () => orderPlacementManager.setProcessingMessage( null ), 57000 );\n\t};\n\n\tdocument.addEventListener(\n\t\t'DOMContentLoaded',\n\t\t() => {\n\t\t\tlog( 'dom ready, setup listeners' );\n\n\t\t\tsetupClassicCheckoutListeners();\n\t\t\tsetOnPaymentUnsuccessfulNonce( PayoneerData.onPaymentUnsuccessfulNonce );\n\n\t\t\tconst $orderReviewForm = $( '#order_review' );\n\n\t\t\tdefaultHooks.addFilter(\n\t\t\t\t'payoneer.webSdk.onSdkError',\n\t\t\t\t'payoneer/paymentCheckout',\n\t\t\t\t( isResolved, checkout, component, data ) => {\n\t\t\t\t\tlog( 'hook onSdkError', { isResolved, data } );\n\n\t\t\t\t\tconst { payOrderErrorFlag } = window.PayoneerData;\n\t\t\t\t\tconst url = new URL( document.location );\n\n\t\t\t\t\turl.searchParams.set( payOrderErrorFlag, true );\n\t\t\t\t\twindow.location.href = url.toString();\n\t\t\t\t\treturn isResolved;\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tdefaultHooks.addFilter(\n\t\t\t\t'payoneer.webSdk.onPaymentDeclined',\n\t\t\t\t'payoneer/paymentCheckout',\n\t\t\t\tasync ( continueDefaultErrorHandling, sdk, componentName, responseData ) => {\n\t\t\t\t\tlog( 'hook onPaymentDeclined' );\n\t\t\t\t\thandlePaymentUnsuccessful(responseData, 'declined');\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tdefaultHooks.addFilter(\n\t\t\t\t'payoneer.webSdk.onPaymentFailure',\n\t\t\t\t'payoneer/paymentCheckout',\n\t\t\t\tasync ( continueDefaultErrorHandling, sdk, componentName, responseData ) => {\n\t\t\t\t\tlog( 'hook onPaymentFailure' );\n\t\t\t\t\thandlePaymentUnsuccessful(responseData, 'failure');\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tconst handlePaymentUnsuccessful = async function (responseData, paymentResult){\n\t\t\t\tawait releaseOnHoldOrder( {\n\t\t\t\t\tlongId: payoneerStore.getLongId(),\n\t\t\t\t\torderKey: new URLSearchParams( window.location.search ).get( 'key' ),\n\t\t\t\t\terrorTitleToDisplay: responseData.interaction?.customerMessage?.title ?? 'Payment failed',\n\t\t\t\t\terrorTextToDisplay: responseData.interaction?.customerMessage?.text ?? 'Please try again.',\n\t\t\t\t\tpaymentResult\n\t\t\t\t} );\n\n\t\t\t\twindow.location.reload();\n\t\t\t};\n\n\t\t\t/**\n\t\t\t * The \"pay for order\" page does not trigger the \"checkout_place_order\" event.\n\t\t\t */\n\t\t\t$orderReviewForm.on( 'submit', ( e ) => {\n\t\t\t\tlog( 'event submit' );\n\t\t\t\tif ( !isPayoneerGatewaySelected() || payoneerStore.isHostedModeForced() ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopImmediatePropagation();\n\n\t\t\t\tconst { isValid, isReady, key } = payoneerStore.getActiveComponent();\n\n\t\t\t\tif ( !isReady || !isValid ) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tfocusOnSelectedGateway();\n\t\t\t\t\t} catch ( error ) {\n\t\t\t\t\t\tconsole.error( error );\n\t\t\t\t\t}\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Block the Pay button.\n\t\t\t\torderPlacementManager.setProcessing( true );\n\n\t\t\t\tsubmitOrderPayViaAjax( $orderReviewForm )\n\t\t\t\t\t.then( () => {\n\t\t\t\t\t\tpayWithPayoneer();\n\t\t\t\t\t\tshowCancelButton( key );\n\t\t\t\t\t} )\n\t\t\t\t\t.catch( () => {\n\t\t\t\t\t\t/**\n\t\t\t\t\t\t * Reloading enables us to see error messages added via wc_add_notice()\n\t\t\t\t\t\t * Scrolling up makes sure the notices are in the viewport after the refresh\n\t\t\t\t\t\t */\n\t\t\t\t\t\twindow.scrollTo( 0, 0 );\n\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t} );\n\t\t\t} );\n\n\t\t\tmountComponents();\n\t\t},\n\t\tfalse\n\t);\n};\n","import { isBlockCheckout, isPayForOrder } from './src/util/woocommerce';\nimport { setupCustomHttpHeaders } from './src/util/http';\nimport { initClassicCheckout } from \"./src/util/checkout/classicCheckout\";\nimport { initBlockCheckout } from \"./src/util/checkout/blockCheckout\";\nimport { initPaymentCheckout } from \"./src/util/checkout/paymentCheckout\";\n\n\ndocument.addEventListener(\n\t'DOMContentLoaded',\n\tsetupCustomHttpHeaders,\n\tfalse\n);\n/**\n * Boot one of the supported checkout integrations.\n * Let us hope this list is getting shorter, not longer\n */\nif ( isPayForOrder() ) {\n\tinitPaymentCheckout()\n} else if ( isBlockCheckout() ) {\n\tinitBlockCheckout();\n} else {\n\tinitClassicCheckout()\n}\n\n"],"names":["f","k","Symbol","for","m","Object","prototype","hasOwnProperty","n","__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED","ReactCurrentOwner","p","key","ref","__self","__source","exports","jsx","c","a","g","b","d","e","h","call","defaultProps","$$typeof","type","props","_owner","current","module","window","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","getter","__esModule","definition","o","defineProperty","enumerable","get","obj","prop","r","toStringTag","value","paymentFieldsComponentAttribute","PayoneerData","selectedPaymentGateway","document","querySelector","isPayoneerGatewaySelected","isPayoneerGateway","gatewayId","_selectedPaymentGatew2","id","test","paymentMethodId","isPayForOrder","focusOnSelectedGateway","focus","ACTIONS","SET_EXTENSION_DATA","SET_LONG_ID","SET_LIST_URL","SET_ENV","SET_SDK","SET_SDK_VERSION","SET_SDK_INTEGRITY","SET_SDK_STATE","PAY","SET_ACTIVE_PAYMENT_METHOD","SET_FORCE_HOSTED_FLOW","SET_ORDER_ID","SET_ON_PAYMENT_UNSUCCESSFUL_NONCE","ADD_COMPONENT","REMOVE_COMPONENT","SET_IS_VALID","SET_IS_MOUNTED","SET_IS_READY","MOUNT_COMPONENTS","initialState","activePaymentMethod","longId","env","sdkState","forceHostedFlow","components","reduceComponent","state","componentName","updates","prevComponent","instance","isMounted","isReady","isValid","getComponentNameByGatewayId","log","args","console","setLongId","async","select","resolveSelect","dispatch","sdk","getSdk","updateLongId","payload","setSdkState","setEnv","pay","getActiveComponent","onBeforeError","component","data","error","includes","interaction","reason","setForceHostedFlow","defaultHooks","applyFilters","onPaymentDeclined","onPaymentFailure","onValidationInfo","normalizedName","normalizeComponentName","_data$methodName","methodName","setIsValid","valid","setIsReady","setActivePaymentMethod","method","mountComponents","setOnPaymentUnsuccessfulNonce","nonce","setOrderId","orderId","releaseOnHoldOrder","requestData","targetUrlBase","wc_checkout_params","wc_ajax_url","toString","replace","separator","targetUrl","onPaymentUnsuccessfulNonce","Promise","resolve","reject","$","url","xhrFields","withCredentials","dataType","success","catch","onComponentListChange","changeInfo","addedComponents","forEach","name","addComponentToContainer","removedComponents","removeComponentFromContainer","isDroppedIn","dropIn","hidePaymentButton","registerComponent","getComponentByName","mountUnknownComponent","unregisterComponent","initPayoneerComponents","getLongId","reboot","unmountAllComponents","doAction","wp","invalidateResolutionForStore","getAllComponents","entries","item","mountSdkComponent","isAvailable","container","findComponentContainer","Element","mount","setIsMounted","element","isRedirectComponent","keys","flag","websdkStyles","styles","getEnv","sdkVersion","getSdkVersion","sdkIntegrity","getSdkIntegrity","config","preload","refetchListBeforeCharge","Payoneer","CheckoutWeb","script","createElement","src","formatUmdUrl","scriptVersion","URL","webSdkUmdUrlTemplate","onload","onerror","integrity","crossOrigin","head","appendChild","then","nonLoadingState","interval","setInterval","clearInterval","getExtensionData","response","apiFetch","path","cache","parse","payoneerExtensionData","json","extensions","extensionData","environment","extension","isHostedModeForced","getActivePaymentMethod","getOrderId","getOnPaymentUnsuccessfulNonce","_state$components$com","_state$components$com2","PAYONEER_STORE_KEY","payoneerStore","createReduxStore","reducer","listUrl","removed","actions","selectors","resolvers","register","FORCE_HOSTED_MODE_HEADER","IS_PAYMENT_CHECKOUT","getCustomHeaders","customHeaders","String","URLSearchParams","location","search","addAction","addFilter","headers","setupClassicCheckoutListeners","paymentMethodCallback","_selectedPaymentGatew","paymentMethodName","jQuery","body","on","setupComponentObserver","OBSERVED_PROPERTIES","store","knownState","waitingTimer","waitForStableComponent","attempt","didChange","didComponentChange","active","some","updateKnownState","setTimeout","unsubscribe","subscribe","observeActiveComponent","BODY_CLASS_STATE_READY","BODY_CLASS_STATE_INVALID","BODY_CLASS_STATE_PROCESSING","processing","constructor","selector","this","area","button","find","isPaymentAllowed","isAreaBlocked","isButtonDisabled","validPaymentInput","setValidInput","setProcessing","setProcessingMessage","message","setActive","newClass","STATES","classList","remove","add","block","overlayCSS","background","opacity","blockMsgClass","css","maxWidth","width","cursor","fadeIn","unblock","addClass","removeClass","textContent","baseSelector","payWithPayoneer","rebootPayoneer","WidgetContainer","withSelect","ownProps","payoneer","eventRegistration","canMakePayment","provider","paymentMethodData","onPaymentSetup","onCheckoutSuccess","onCheckoutFail","useEffect","_jsx","className","errorMessageStorageKey","addEventListener","originalFetch","fetch","options","origin","XMLHttpRequest","originalOpen","open","originalSend","send","rest","_isSameOrigin","apply","header","setRequestHeader","initPaymentCheckout","orderPlacementManager","OrderPlacementManager","$cancelButton","text","reload","$orderReviewForm","isResolved","checkout","payOrderErrorFlag","searchParams","set","href","continueDefaultErrorHandling","responseData","handlePaymentUnsuccessful","paymentResult","_responseData$interac","_responseData$interac2","orderKey","errorTitleToDisplay","customerMessage","title","errorTextToDisplay","preventDefault","stopImmediatePropagation","$form","ajax_url","action","fields","serialize","params","always","paymentMethod","testCancelButton","localStorage","getItem","showCancelButton","scrollTo","isBlockCheckout","setUpBlockCheckoutListeners","currentPaymentMethod","wcPaymentStore","PAYMENT_STORE_KEY","paymentStoreCallback","Array","isArray","inpsydeGateways","gatewayName","hooks","push","icons","registerPageReloadingOnPaymentUnsuccessful","payoneerOrderId","errorMessage","sessionStorage","setItem","JSON","stringify","removeItem","createErrorNotice","context","isDismissible","attempts","maxAttempts","warn","noticeElement","scrollIntoView","behavior","displayErrorMessages","initClassicCheckout","$checkoutForm","trigger","handleUnsuccessfulPayment","result","redirect","event","msg","finally"],"sourceRoot":""}